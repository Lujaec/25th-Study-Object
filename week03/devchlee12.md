# 3장 : 역할, 책임, 협력

- 이번 장은 객체지향의 본질인 역할, 책임, 협력이 무엇인지, 왜 이러한 개념이 필요한지에 대해 다룬다
- 이전까지 배웠던 클래스, 상속, 지연 바인딩은 구현측면에 치우쳐짐
- 객체지향의 핵심은 역할, 책임, 협력

### 협력

- 객체지향 원칙을 따르는 앱의 제어 흐름은 하나의 객체에 의해 통제되지 않고, 다양한 객체들에게 균형있게 분배됨
- 객체들은 기능을 구현하기 위해 메시지를 주고받으며 상호작용
    - 이 상호작용을 협력이라고 함
    - 메시지 수신한 객체는 스스로 메시지 처리 방법(메서드)을 선택
- 어떤 객체에게 처리를 위임할 것인가?
    - 관련 정보 가장 잘 알고 있는 객체 (일반적으로)
        - 왜? → 자율성을 보장하기 위해
        - 자울적인 객체는 자신의 책임 수행 중 필요한 정보 알지 못하거나 외부 도움 필요하면 적절한 객체에게 메시지 전송하여 협력 요청
- 협력이 설계를 위한 문맥을 결정한다
    - 객체의 존재 이유는 협력
    - 협력이 객체의 행동을 결정함
    - 예를 들어, Movie객체는 어떤 행동 수행해야하는가
        - play? calculateMovieFee?
        - 만약 Movie가 영화를 예매하기 위한 협력에 참여한다면 calculateMovieFee를 수행해야함
    - 즉, 협력이 문맥을 제공하고, 행동을 결정 → 상태는 행동하는데 필요한 정보에 의해 결정되므로 상태도 결정

### 책임

- 책임이란 무엇인가
    - 협력에 참여하기 위해 객체가 수행하는 행동
    - 객체가 유지해야 하는 정보와 수행할 수 있는 행동에 대해 개력적으로 서술한 문장
    - 객체의 책임
        - 하는것과 아는것
- 책임은 CRC카드로 표현할 수 있음
    
    ![image](https://github.com/user-attachments/assets/1b211a4d-42ee-4e62-bb90-dac8756db9ba)
    
- 그렇다면 책임은 메시지일까?
    - 책임은 메시지보다 추상적이고 개념적으로도 더 큼
    - 여러개의 메시지로 분할되기도 하고, 여러 객체들이 협력해야하는 커다란 책임으로 자라기도 함
- 책임 할당
    - 정보 전문가 패턴
        - 책임 수행에 필요한 정보 가장 잘 아는 전문가에게 책임 할당
- 영화 예매 시스템을 예로 들어 전문가에게 책임 할당하는 방법 살펴보기
    - 시스템의 책임은 ‘예매하라’
    - 예매 관련 정보 가장 많이 알고 있는 객체는 ‘Screening’
    - 그런데 Screening은 영화 가격 몰라서 가격 계산 못함
    - 따라서 ‘가격 계산하라’ 라는 메시지 필요
    - 가격 가장 잘 아는 것은 Movie니까 Movie에게 가격 계산 책임 할당
- 책임 주도 설계
    - 위 사례처럼 책임을 찾고 적절한 객체에 할당하면서 협력 설계하는 것
    - 과정
        - 시스템 책임 파악
        - 시스템 책임을 더 작은 책임으로 분할
        - 분할된 책임을 적절한 객체나 역할에게 할당
        - 객체가 책임을 수행하는 도중 다른 객체 도움 필요하면 적절한 객체나 역할을 찾음
        - 해당 객체 또는 역할에 책임 할당
- 메시지가 객체를 결정한다
    - 왜 메시지가 객체를 결정해야할까?
        - 최소한의 인터페이스를 가지게함
            - 메시지 식별될 때 까지 인터페이스에 아무것도 추가하지 않으므로
        - 충분히 추상적인 인터페이스를 가질 수 있게함
            - 메시지를 먼저 식별하므로
- 행동이 상태를 결정한다
    - 행동을 통해 협력에 참여하므로 행동은중요함
    - 상태를 통해 행동을 결정하면 내부구현이 노출
    - 상태는 객체가 행동을 수행하기 위한 재료 정도임

### 역할

- 역할과 협력
    - 역할이란, 객체가 특정한 협력 안에서 수행하는 책임의 집합
- 왜 굳이 객체 말고 역할이라는 개념이 있는가?
    - 유연하고 재사용 가능한 협력 얻을 수 있음
    - 만약 역할을 사용하지 않는다면?
        
        ![image 1](https://github.com/user-attachments/assets/33524270-3f16-4809-8b48-9e80f82b7b00)
        
        - 두가지 종류의 협력을 만들어야함
    - 역할을 사용한다면?
        
        ![image 2](https://github.com/user-attachments/assets/92598b5f-eb98-4351-bdd2-6801a558ca14)
        
    - 역할은 객체를 바꿔끼울 수 있는 일종의 슬롯
- 객체 대 역할
    - 오직 한 종류의 객체만 협력에 참여하면 역할 필요 없는거 아닌가?
        - 협력에 적합한 책임 수행하는 대상 한종류면 간단히 객체로 간주
        - 여러 종류 객체 참여 가능하면 역할
    - 대부분의 경우 어떤것이 역할이고, 객체인지 또렷이 안드러남
        - 따라서 적절한 책임과 협력의 큰 그림 탐색하는 것이 중요
        - 굳이 구분하는거 별로 안중요
        - 애매하면 객체로 시작하고 나중에 역할로 합쳐라
- 역할과 추상화
    - 역할을 통해 상위수준에서 협력을 설명 가능
        - 복잡성 제거
    - 역할을 통해 설계를 유연하게 만들 수 있음
        - 역할은 일종의 슬롯
- 배우와 배역
    - 배우와 배역의 은유를 통해 역할과 협력의 관계를 알 수 있음
    - 협력은 연극, 역할은 배역, 객체는 배우
    - 여러 객체가 동일한 역할 수행 가능하고, 같은 객체가 여러 역할 수행도 가능함
    - 하지만 특정한 협력 안에서는 오직 하나의 역할만 보여진다
