# 협력 → 행동 → 상태 → 책임

객체지향 패러다임의 핵심은 역할, 책임, 협력
협력 : 객체들이 애플리케이션의 기능을 구현하기 위해 수행하는 상호작용
책임 : 객체가 협력에 참여하기 위해 수행하는 로직
역할 : 협력 안에서 수행하는 책임들이 모여 객체가 수행하는 것
  
---
# 협력

- 기능을 구현할 수 있는 유일한 방법
- 하나의 객체가 다른 객체에게 도움을 요청할 때 두 객체 사이의 협력이 시작됨
- 객체의 행동을 결정함 (협력이 바뀌면, 객체가 제공해야하는 행동이 바뀜)
    - 협력 : 객체의 행동을 결정
    - 행동 : 객체의 상태를 결정, 협력 안에서 객체가 처리할 메시지로 결정됨
    - 상태 : 객체가 행동을 수행하는 데 필요한 정보로 결정됨
- 객체를 설계하는데 필요한 일종의 문맥을 제공
- 상태는 객체가 행동하는데 필요한 정보에 의해 결정되며, 행동은 협력 안에서 객체가 처리해야할 메시지로 결정됨. 결과적으로 객체가 참여하는 협력이 객체를 구성하는 행동과 상태를 모두 결정함. 따라서 협력은 객체를 설계하는데 필요한 일종의 문맥을 제공


> 협력을 하는 방법 = 메시지 전송
> 메시지 전송을 통해 객체 사이의 협력을 위한 커뮤니케이션이 이루어짐
> - 객체는 다른 객체의 상세한 내부 구현에 직접 접근할 수 없기 때문에 오직 메시지 전송을 통해서만 자신의 요청 전달 가능
> -  메시지를 수신한 객체는 요청에 응답 (메서드를 실행하여)
> - 처리할 요청에 대한 방법을 스스로 선택할 수 있음
> - 요청하는 객체는 메시지만 전송할 수 있을 뿐이며, 메시지를 어떻게 처리할지는 메시지를 수신한 객체가 선택함 ( == 객체는 스스로 일을 처리할 수 있는 자율적인 존재)
> 
> **`영화 예매 시스템 예시 (Screening ↔ Movie)`**
> - Screening은 Movie’s calculateMovieFee에 메시지를 전송함으로써 예매자 한 명의 요금 계산을 요구
> - Screening이 직접 처리하지 않고 메시지를 **`요청하는(==위임하는)`** 것은 요금 계산 방법을 가장 잘 알고 있는 객체가 Movie 이기 때문

=> 결과적으로 객체를 자율적으로 만든느 가장 기본적인 방법은 내부 구현을 캡슐화 하는 것
  
  
> **객체들이 협력(소통하는 방법)**
> 1. 객체1은 자신에게 할당된 책임을 수행하던 중에 필요한 정보를 알지 못하거나 외부의 도움이 필요한 경우 객체2에게 메시지를 전송하여 협력을 요청함
> 2. 메시지를 수신한 객체2 역시 정보가 더 필요하다면 객체3에게 도움을 요청함

⇒ 객체들 사이의 협력을 구성하는 일련의 요청과 응답의 흐름을 통해 애플리케이션의 기능이 구현됨  
  
# 책임
- 객체가 협력을 위해서 수행하는 필요한 행동/행위들
- 객체가 유지해야 하는 정보와 수행할 수 있는 행동에 대해 개략적으로 서술한 문장
    - 무엇을 알고 있는가 (아는 것 = knowing)
        - 사적인 정보에 관해 아는 것
        - 관련된 객체에 대해 아는 것
        - 자신이 유도하거나 계산할 수 있는 것에 대해 아는 것
    - 무엇을 할 수 있는가 (하는 것 = doing)
        - 객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것
        - 다른 객체의 행동을 시작시키는 것
        - 다른 객체의 활동을 제어하고 조절하는 것
<img width="451" alt="image" src="https://github.com/user-attachments/assets/f767eaeb-6e07-457f-8a7a-1992b69eb069" />
→ 영화 시스템에서의 역할과 책임
→ 객체는 자신이 맡은 책임을 수행하는데 필요한 정보를 알 고 있을 책임과, **자신이 할 수 없는 작업을 도와줄 객체**를 알고 있을 책임이 있기 때문에 각 객체들이 인스턴스 변수로 다른 객체들을 가지고 있는 것

#### 자신이 할 수 없는 작업을 도와줄 객체
- 다른 객체에게 책임을 할당하는 것 (정보 전문가 패턴)
- 정보 전문가에게 책임을 할당하는 방법 (영화 시스템 예매 서비스)
  
1. 예매하라
- 예매하기 위해서 알아야 하는 정보 : 영화 상영 정보, 요금 등.. ⇒ Screening이 가장 잘 알고 있는 전문가
2. 예매 가격 계산
- 가격과 할일 정보를 가장 잘 알고 있는 전문가 ⇒ Movie


### 메시지가 객체를 결정한다

→ 객체에게 책임을 할당하는 데 필요한 메시지를 먼저 식별하고 메시지를 처리할 객체를 나중에 선택했다는 것이 중요함 (메시지가 객체를 선택하게 했다는 것)

1. 객체가 최소한의 인터페이스를 가질 수 있게 됨
2. 충분히 추상적인 인터페이스를 가질 수 있게 됨
    - 객체의 인터페이스는 무엇만 표현 가능, 어떻게 수행하는 지는 노출하면 안 됨.
    - 메시지는 외부의 객체가 요청하는 무언가를 의미하기 때문에 메시지를 먼저 식별하면 무엇을 수행할지에 초점을 맞추는 인터페이스를 얻을 수 있음
  
  
### 행동이 상태를 결정한다

- 객체의 행동은 객체가 협력에 참여할 수 있는 유일한 방법
- 때문에, 얼마나 적절한 객체를 창조했느냐는 얼마나 적절한 책임을 할당했느냐에 달려있고, 책임이 얼마나 적절한지는 협력에 얼마나 적절한가에 달려있음
  
  
  
# 역할

- 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합
- 예) 영화 예매 서비스의 할인 정책
    - → Screening : 예매하라
    - Screening → Movie : 가격을 계산하라
    - Movie → Amount DiscountPolicy
    - Movie → Percent DiscountPolicy
- DiscountPolicy 를 메시지에 응답할 수 있는 대표자가 있는 하나의 협력으로 통합
    - 대표자를 통해서 종류의 객체를 교대로 바꿔 끼울 수 있으며 코드의 중복을 낮출 수 있음
    - **이것이 일종의 슬롯이자 역할**
    - <img width="457" alt="image" src="https://github.com/user-attachments/assets/62f108bf-ea0c-435d-8fce-b86538c5d2c9" />
    - 두 종류의 구체적인 객체를 포괄하는 추상화를 통해서 역할을 정함으로써 협력을 하나로 통합
    - 추상화는 상황을 단순화 함 (2 → 1)        
- 협력에 참여하는 후보가 한 종류의 객체에 의해 수행 된다면, 해당 후보는 단일 객체
- 협력에 적합한 책임을 수행하는데
    - 여러 종류의 객체들이 참여할 수 있다면 역할
    - 대상이 하나라면 객체
